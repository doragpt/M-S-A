[10]+  Stopped                 python main.py
(venv) root@vm-b3dba883-74:~/M-S-A# apt-get update && apt-get install -y chromium-browser chromium-chromedriver
Hit:1 https://dl.google.com/linux/chrome/deb stable InRelease
Hit:2 http://security.ubuntu.com/ubuntu noble-security InRelease
Hit:3 http://jp.archive.ubuntu.com/ubuntu noble InRelease
Hit:4 http://jp.archive.ubuntu.com/ubuntu noble-updates InRelease
Hit:5 http://jp.archive.ubuntu.com/ubuntu noble-backports InRelease
Reading package lists... Done
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
chromium-browser is already the newest version (2:1snap1-0ubuntu2).
The following NEW packages will be installed:
  chromium-chromedriver
0 upgraded, 1 newly installed, 0 to remove and 40 not upgraded.
Need to get 2,308 B of archives.
After this operation, 18.4 kB of additional disk space will be used.
Get:1 http://jp.archive.ubuntu.com/ubuntu noble/universe amd64 chromium-chromedriver amd64 2:1snap1-0ubuntu2 [2,308 B]
Fetched 2,308 B in 0s (5,145 B/s)
Selecting previously unselected package chromium-chromedriver.
(Reading database ... 146311 files and directories currently installed.)
Preparing to unpack .../chromium-chromedriver_2%3a1snap1-0ubuntu2_amd64.deb ...
Unpacking chromium-chromedriver (2:1snap1-0ubuntu2) ...
Setting up chromium-chromedriver (2:1snap1-0ubuntu2) ...
Scanning processes...
Scanning candidates...
Scanning linux images...

Pending kernel upgrade!
Running kernel version:
  6.8.0-53-generic
Diagnostics:
  The currently running kernel version is not the expected kernel version 6.8.0-55-generic.

Restarting the system to load the new kernel will not be handled automatically, so you should consider rebooting.

Restarting services...

Service restarts being deferred:
 /etc/needrestart/restart.d/dbus.service
 systemctl restart systemd-logind.service
 systemctl restart unattended-upgrades.service

No containers need to be restarted.

User sessions running outdated binaries:
 root @ session #2623: python[476453]
 root @ session #2837: python[1059048]
 root @ session #3312: bash[2709373]
 root @ session #445: python[1992614]
 root @ session #90: python[459841]
 root @ user manager service: systemd[1272]

No VM guests are running outdated hypervisor (qemu) binaries on this host.
(venv) root@vm-b3dba883-74:~/M-S-A# kill -9 $(lsof -t -i:5000)
(venv) root@vm-b3dba883-74:~/M-S-A# git fetch origin main
.pyFrom https://github.com/doragpt/M-S-A
 * branch            main       -> FETCH_HEAD
[10]+  Killed                  python main.py
(venv) root@vm-b3dba883-74:~/M-S-A# git checkout origin/main -- store_scraper.py
(venv) root@vm-b3dba883-74:~/M-S-A# python main.py
テンプレートディレクトリ: /root/M-S-A/templates
静的ファイルディレクトリ: /root/M-S-A/static
2025-03-17 04:18:28,452 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-03-17 04:18:28,456 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-03-17 04:18:28,457 - apscheduler.scheduler - INFO - Added job "scheduled_scrape" to job store "default"
2025-03-17 04:18:28,457 - apscheduler.scheduler - INFO - Added job "<lambda>" to job store "default"
2025-03-17 04:18:28,457 - apscheduler.scheduler - INFO - Scheduler started
2025-03-17 04:18:28,458 - apscheduler.scheduler - DEBUG - Looking for jobs to run
サーバー起動時刻（JST）: 2025-03-17 04:18:28 JST+0900
2025-03-17 04:18:28,463 - apscheduler.scheduler - DEBUG - Next wakeup is due at 2025-03-17 05:18:28.452344+09:00 (in 3599.989351 seconds)
アプリケーションを起動しています: http://0.0.0.0:5000
データベース状態確認: ステータス=2942件, URL=647件
WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
 * Serving Flask app 'main'
 * Debug mode: on
2025-03-17 04:18:28,480 - werkzeug - INFO -  * Running on all addresses (0.0.0.0)
   WARNING: This is a development server. Do not use it in a production deployment.
 * Running on http://127.0.0.1:5000
 * Running on http://160.251.196.100:5000 (Press CTRL+C to quit)
2025-03-17 04:18:28,481 - werkzeug - INFO -  * Restarting with stat
テンプレートディレクトリ: /root/M-S-A/templates
静的ファイルディレクトリ: /root/M-S-A/static
2025-03-17 04:18:29,375 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-03-17 04:18:29,379 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-03-17 04:18:29,379 - apscheduler.scheduler - INFO - Added job "scheduled_scrape" to job store "default"
2025-03-17 04:18:29,380 - apscheduler.scheduler - INFO - Added job "<lambda>" to job store "default"
2025-03-17 04:18:29,380 - apscheduler.scheduler - INFO - Scheduler started
2025-03-17 04:18:29,380 - apscheduler.scheduler - DEBUG - Looking for jobs to run
サーバー起動時刻（JST）: 2025-03-17 04:18:29 JST+0900
2025-03-17 04:18:29,385 - apscheduler.scheduler - DEBUG - Next wakeup is due at 2025-03-17 05:18:29.374971+09:00 (in 3599.989612 seconds)
アプリケーションを起動しています: http://0.0.0.0:5000
データベース状態確認: ステータス=2942件, URL=647件
2025-03-17 04:18:29,401 - werkzeug - WARNING -  * Debugger is active!
2025-03-17 04:18:29,405 - werkzeug - INFO -  * Debugger PIN: 452-729-233
2025-03-17 04:18:32,548 - __main__ - INFO - 定期スクレイピングを開始します
2025-03-17 04:18:32,558 - __main__ - INFO - スクレイピング開始: 対象店舗数 647
2025-03-17 04:18:32,559 - asyncio - DEBUG - Using selector: EpollSelector
2025-03-17 04:18:32,559 - app - INFO - スクレイピングを開始します（店舗数: 647、並列実行数: 14）
2025-03-17 04:19:02,628 - __main__ - ERROR - スクレイピング処理中にエラーが発生しました: Browser closed unexpectedly:

2025-03-17 04:19:02,630 - apscheduler.scheduler - DEBUG - Looking for jobs to run
2025-03-17 04:19:02,631 - apscheduler.scheduler - DEBUG - Next wakeup is due at 2025-03-17 05:19:02.629720+09:00 (in 3599.998406 seconds)
2025-03-17 04:19:02,639 - werkzeug - INFO - 182.171.40.172 - - [17/Mar/2025 04:19:02] "POST /admin/manual_scrape HTTP/1.1" 500 -
Traceback (most recent call last):
  File "/root/M-S-A/venv/lib/python3.12/site-packages/flask/app.py", line 2486, in __call__
    return self.wsgi_app(environ, start_response)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/M-S-A/venv/lib/python3.12/site-packages/flask_socketio/__init__.py", line 43, in __call__
    return super(_SocketIOMiddleware, self).__call__(environ,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/M-S-A/venv/lib/python3.12/site-packages/engineio/middleware.py", line 74, in __call__
    return self.wsgi_app(environ, start_response)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/M-S-A/venv/lib/python3.12/site-packages/flask/app.py", line 2466, in wsgi_app
    response = self.handle_exception(e)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/M-S-A/venv/lib/python3.12/site-packages/flask/app.py", line 2463, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/M-S-A/venv/lib/python3.12/site-packages/flask/app.py", line 1761, in full_dispatch_request
    return self.finalize_request(rv)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/M-S-A/venv/lib/python3.12/site-packages/flask/app.py", line 1782, in finalize_request
    response = self.process_response(response)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/M-S-A/venv/lib/python3.12/site-packages/flask/app.py", line 2278, in process_response
    self.session_interface.save_session(self, ctx.session, response)
  File "/root/M-S-A/venv/lib/python3.12/site-packages/flask/sessions.py", line 410, in save_session
    response.set_cookie(
  File "/root/M-S-A/venv/lib/python3.12/site-packages/werkzeug/sansio/response.py", line 234, in set_cookie
    dump_cookie(
  File "/root/M-S-A/venv/lib/python3.12/site-packages/werkzeug/http.py", line 1212, in dump_cookie
    path = iri_to_uri(path, charset)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/M-S-A/venv/lib/python3.12/site-packages/werkzeug/urls.py", line 813, in iri_to_uri
    path = url_quote(iri.path, charset, errors, _to_uri_safe)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/urllib/parse.py", line 917, in quote
    string = string.encode(encoding, errors)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
LookupError: unknown encoding: strict